<?php

/* @autogenerated */
declare(strict_types=1);

namespace Civi\Lughauth\Shared\Security;

/**
 * Represents a permission decision with a boolean flag (`allowed`) and contextual metadata.
 */
class Allow
{
    /**
     * Combines two Allow instances using logical OR semantics.
     *
     * If the first permission is allowed, returns a new Allow instance marked as allowed.
     * Otherwise, returns the second permission's status.
     *
     * @param string $name Name of the resulting permission decision.
     * @param Allow $one First permission to evaluate.
     * @param Allow $other Second permission to evaluate if the first is disallowed.
     * @return Allow Resulting permission decision.
     */
    public static function or(string $name, Allow $one, Allow $other)
    {
        return $one->allowed ? new Allow(true, $name, $one->reason) : new Allow($other->allowed, $name, $other->reason);
    }

    /**
     * Combines two Allow instances using logical AND semantics.
     *
     * If the first permission is disallowed, the result is disallowed regardless of the second.
     * If the first is allowed, the result depends on the second permission.
     *
     * @param string $name Name of the resulting permission decision.
     * @param Allow $one First permission to evaluate.
     * @param Allow $other Second permission to evaluate if the first is allowed.
     * @return Allow Resulting permission decision.
     */
    public static function and(string $name, Allow $one, Allow $other)
    {
        return $one->allowed ? new Allow($other->allowed, $name, $other->reason) : new Allow(false, $name, $one->reason);
    }

    /**
     * Creates an Allow instance marked as allowed.
     *
     * @param string $name Name of the permission.
     * @param string|null $reason Optional reason for allowing.
     * @return Allow
     */
    public static function allowed(string $name, ?string $reason = null)
    {
        return new Allow(allowed: true, name: $name, reason: $reason);
    }

    /**
     * Creates an Allow instance marked as disallowed.
     *
     * @param string $name Name of the permission.
     * @param string|null $reason Optional reason for disallowing.
     * @return Allow
     */
    public static function disallowed(string $name, ?string $reason = null)
    {
        return new Allow(allowed: false, name: $name, reason: $reason);
    }

    /**
     * @param bool $allowed Whether the permission is granted (true) or denied (false).
     * @param string $name Name or label identifying the permission.
     * @param string|null $reason Optional explanation or rationale for the decision.
     */
    public function __construct(
        public readonly bool $allowed,
        public readonly string $name,
        public readonly ?string $reason = null,
    ) {
    }
}
