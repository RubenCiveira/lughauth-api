<?php

/* @autogenerated */
declare(strict_types=1);

namespace Civi\Lughauth\Shared\Infrastructure\Management\Routes;

use Closure;
use Override;
use Slim\App;
use Civi\Lughauth\Shared\Infrastructure\Management\ManagementInterface;

class RoutesManagement implements ManagementInterface
{
    public function __construct(private readonly App $app)
    {
    }

    #[Override]
    public function name(): string
    {
        return 'routes';
    }

    #[Override]
    public function get(): ?Closure
    {
        return function (): array {
            $routeCollector = $this->app->getRouteCollector();
            $routes = $routeCollector->getRoutes();
            $declaredRoutes = [];
            foreach ($routes as $route) {
                $methods = $route->getMethods();
                $pattern = $route->getPattern();
                $name = $route->getName();
                foreach ($methods as $method) {
                    $declaredRoutes[] = [
                        'method' => $method,
                        'path' => $pattern . ($name ? " [name: $name]" : '')
                    ];
                }
            }
            return $declaredRoutes;
        };
    }

    #[Override]
    public function set(): ?Closure
    {
        return null;
    }
}
