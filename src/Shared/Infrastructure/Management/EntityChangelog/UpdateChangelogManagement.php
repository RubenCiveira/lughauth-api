<?php

/* @autogenerated */
declare(strict_types=1);

namespace Civi\Lughauth\Shared\Infrastructure\Management\EntityChangelog;

use Closure;
use Override;
use Civi\Lughauth\Shared\Infrastructure\EntityChangelog\EntityChangelogSyncEvent;
use Civi\Lughauth\Shared\Infrastructure\Management\ManagementInterface;
use Psr\EventDispatcher\EventDispatcherInterface;

/**
 * Triggers a changelog synchronization run.
 */
class UpdateChangelogManagement implements ManagementInterface
{
    /**
     * Creates a new changelog update management handler.
     */
    public function __construct(
        /** @var EventDispatcherInterface Event dispatcher for sync events. */
        private readonly EventDispatcherInterface $dispacher
    ) {
    }

    /**
     * Returns the management endpoint name.
     */
    #[Override]
    public function name(): string
    {
        return 'entity-changelog-update';
    }

    /**
     * Returns a handler that dispatches the sync event.
     *
     * @return Closure|null Closure that triggers the update.
     */
    #[Override]
    public function get(): ?Closure
    {
        return function (): array {
            $this->dispacher->dispatch(new EntityChangelogSyncEvent());
            return [];
        };
    }

    /**
     * No write handler is provided for changelog updates.
     */
    #[Override]
    public function set(): ?Closure
    {
        return null;
    }
}
