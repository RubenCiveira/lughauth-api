<?php

# @autogenerated
declare(strict_types=1);

namespace Civi\Lughauth\Features\Access\ScopeAssignation\Domain;

use Civi\Lughauth\Features\Access\ScopeAssignation\Domain\ValueObject\ScopeAssignationUidVO;
use Civi\Lughauth\Features\Access\ScopeAssignation\Domain\ValueObject\ScopeAssignationSecurityDomainVO;
use Civi\Lughauth\Features\Access\ScopeAssignation\Domain\ValueObject\Accesor\ScopeAssignationSecurityDomainAccesor;
use Civi\Lughauth\Features\Access\ScopeAssignation\Domain\ValueObject\ScopeAssignationSecurityScopeVO;
use Civi\Lughauth\Features\Access\ScopeAssignation\Domain\ValueObject\Accesor\ScopeAssignationSecurityScopeAccesor;
use Civi\Lughauth\Features\Access\ScopeAssignation\Domain\ValueObject\ScopeAssignationVersionVO;
use Civi\Lughauth\Features\Access\ScopeAssignation\Domain\ValueObject\Accesor\ScopeAssignationVersionAccesor;
use Civi\Lughauth\Features\Access\ScopeAssignation\Domain\Event\ScopeAssignationCreateEvent;
use Civi\Lughauth\Features\Access\ScopeAssignation\Domain\Event\ScopeAssignationUpdateEvent;
use Civi\Lughauth\Features\Access\ScopeAssignation\Domain\Event\ScopeAssignationDeleteEvent;
use Civi\Lughauth\Features\Access\SecurityDomain\Domain\SecurityDomainRef;
use Civi\Lughauth\Features\Access\SecurityScope\Domain\SecurityScopeRef;

class ScopeAssignation extends ScopeAssignationRef
{
    use ScopeAssignationSecurityDomainAccesor;
    use ScopeAssignationSecurityScopeAccesor;
    use ScopeAssignationVersionAccesor;
    private array $recordedEvents = [];

    public function __construct(
        ScopeAssignationUidVO|string $uid,
        ScopeAssignationSecurityDomainVO|SecurityDomainRef $securityDomain,
        ScopeAssignationSecurityScopeVO|SecurityScopeRef $securityScope,
        ScopeAssignationVersionVO|int|null $version = null,
    ) {
        parent::__construct($uid);
        $this->_securityDomain = ScopeAssignationSecurityDomainVO::from($securityDomain);
        $this->_securityScope = ScopeAssignationSecurityScopeVO::from($securityScope);
        $this->_version = null === $version ? ScopeAssignationVersionVO::empty() : ScopeAssignationVersionVO::from($version);
    }
    public function replace(ScopeAssignationAttributes $values): ScopeAssignation
    {
        $value = clone $this;
        $value->_securityDomain = $values->getSecurityDomainOrDefault($this->_securityDomain);
        $value->_securityScope = $values->getSecurityScopeOrDefault($this->_securityScope);
        $value->_version = $values->getVersionOrDefault($this->_version);
        return $value;
    }
    public static function calculatedFields(): array
    {
        return [];
    }
    public static function create(ScopeAssignationAttributes $values): ScopeAssignation
    {
        $value = $values->build();
        $value->recordedEvents[] = new ScopeAssignationCreateEvent($value);
        return $value;
    }
    public function update(ScopeAssignationAttributes $values): ScopeAssignation
    {
        $value = $this->replace($values);
        $value->recordedEvents[] = new ScopeAssignationUpdateEvent($value);
        return $value;
    }
    public function delete(): ScopeAssignation
    {
        $value = clone $this;
        $value->recordedEvents[] = new ScopeAssignationDeleteEvent($value);
        return $value;
    }
    public function toAttributes(): ScopeAssignationAttributes
    {
        return (new ScopeAssignationAttributes())
          ->uid($this->uid())
          ->securityDomain($this->_securityDomain)
          ->securityScope($this->_securityScope)
          ->version($this->_version);
    }
    public function getTheEvents(): array
    {
        return [...$this->recordedEvents];
    }
}
