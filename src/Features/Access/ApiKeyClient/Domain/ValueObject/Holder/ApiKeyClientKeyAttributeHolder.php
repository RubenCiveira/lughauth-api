<?php

# @autogenerated
declare(strict_types=1);

namespace Civi\Lughauth\Features\Access\ApiKeyClient\Domain\ValueObject\Holder;

use Civi\Lughauth\Shared\Value\Validation\ConstraintFailList;
use Civi\Lughauth\Features\Access\ApiKeyClient\Domain\ValueObject\ApiKeyClientKeyVO;

trait ApiKeyClientKeyAttributeHolder
{
    protected ApiKeyClientKeyVO|string|null $key = null;
    protected bool $keyAssigned = false;

    public function getKeyOrDefault(?ApiKeyClientKeyVO $key): ApiKeyClientKeyVO|string|null
    {
        return $this->keyAssigned ? ($this->key !== null ? ApiKeyClientKeyVO::from($this->key) : null) : $key;
    }
    public function key(ApiKeyClientKeyVO|string|null $key): static
    {
        $this->key = $key;
        $this->keyAssigned = true;
        return $this;
    }
    public function getKey(): ?string
    {
        return is_a($this->key, ApiKeyClientKeyVO::class) ? $this->key->value() : $this->key;
    }
    public function unsetKey(): static
    {
        $this->key = null;
        $this->keyAssigned = false;
        return $this;
    }
    protected function withDefaultKey(): void
    {
    }
    protected function withAssertedKeyRules(self $value, ConstraintFailList $errorsList): void
    {
        if ($value->keyAssigned = $this->keyAssigned) {
            $value->key = ApiKeyClientKeyVO::tryFrom($this->key, $errorsList);
        }
    }
}
