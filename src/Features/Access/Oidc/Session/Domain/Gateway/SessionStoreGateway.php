<?php

/* @autogenerated */
declare(strict_types=1);

namespace Civi\Lughauth\Features\Access\Oidc\Session\Domain\Gateway;

use PDO;
use Civi\Lughauth\Features\Access\Oidc\Authentication\Domain\AuthenticationResult;
use Civi\Lughauth\Features\Access\Oidc\Authentication\Domain\AuthorizedChalleges;
use Civi\Lughauth\Features\Access\Oidc\Client\Domain\ClientData;
use Civi\Lughauth\Features\Access\Oidc\Session\Domain\SessionInfo;
use Civi\Lughauth\Features\Access\Oidc\Session\Infrastructure\Driven\SessionStoreSqlAdapter;

class SessionStoreGateway
{
    private readonly SessionStoreRepository $repository;

    public function __construct(PDO $conn)
    {
        $this->repository = new SessionStoreSqlAdapter($conn);
    }

    public function loadSession(string $state): ?SessionInfo
    {
        return $this->repository->loadSession($state);
    }

    public function saveSession(
        string $state,
        ClientData $clientDetails,
        string $issuer,
        AuthorizedChalleges $keypass,
        AuthenticationResult $validationData,
        string $csid,
        \DateInterval $expiration
    ) {
        return $this->repository->saveSession($state, $clientDetails, $issuer, $keypass, $validationData, $csid, $expiration);
    }

    public function updateSession(string $newState, string $oldState)
    {
        $this->repository->updateSession($newState, $oldState);
    }

    public function deleteSession(string $state)
    {
        $this->repository->deleteSession($state);
    }
}
