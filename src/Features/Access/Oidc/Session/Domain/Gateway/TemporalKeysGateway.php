<?php

/* @autogenerated */
declare(strict_types=1);

namespace Civi\Lughauth\Features\Access\Oidc\Session\Domain\Gateway;

use Psr\Container\ContainerInterface;
use Civi\Lughauth\Features\Access\Oidc\Session\Domain\TemporalAuthCode;
use Civi\Lughauth\Features\Access\Oidc\Session\Infrastructure\Driven\TemporalKeysSqlAdapter;

class TemporalKeysGateway
{
    private readonly TemporalKeysRepository $repository;

    public function __construct(ContainerInterface $container, ?TemporalKeysRepository $repository = null)
    {
        $this->repository = null == $repository ? $container->get(TemporalKeysSqlAdapter::class) : $repository;
    }

    public function currentKey(): string
    {
        return $this->repository->currentKey();
    }

    public function encrypt(string $token): ?string
    {
        return $this->repository->encrypt($token);
    }

    public function verifyCypher(string $token): ?string
    {
        return $this->repository->verifyCypher($token);
    }

    public function verifyToken(string $token): ?string
    {
        return $this->repository->verifyToken($token);
    }

    public function registerTemporalAuthCode(TemporalAuthCode $code): string
    {
        return $this->repository->registerTemporalAuthCode($code);
    }

    public function retrieveTemporalAuthCode(string $code): ?TemporalAuthCode
    {
        return $this->repository->retrieveTemporalAuthCode($code);
    }
}
