<?php

/* @autogenerated */
declare(strict_types=1);

namespace Civi\Lughauth\Features\Access\Oidc\Mfa\Domain;

use RobThree\Auth\TwoFactorAuth;
use RobThree\Auth\Providers\Qr\EndroidQrCodeProvider; // if using Endroid

class OtpMfaService
{
    public function verifyOtp($secret, $otp)
    {
        $delegated = new TwoFactorAuth(new EndroidQrCodeProvider());
        return $delegated->verifyCode($secret, $otp);
    }

    public function generateSeed()
    {
        $delegated = new TwoFactorAuth(new EndroidQrCodeProvider());
        return $delegated->createSecret();
    }

    public function buildInlineQrImage($secret, $label, $issuer)
    {
        $delegated = new TwoFactorAuth(new EndroidQrCodeProvider(), $issuer);
        return $delegated->getQRCodeImageAsDataUri($label, $secret);
    }

    public function buildUrl($secret, $label, $issuer)
    {
        $delegated = new TwoFactorAuth(new EndroidQrCodeProvider(), $issuer);
        return $delegated->getQRText($label, $secret);
    }
}
