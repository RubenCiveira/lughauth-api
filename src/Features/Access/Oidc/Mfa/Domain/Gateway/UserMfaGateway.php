<?php

/* @autogenerated */
declare(strict_types=1);

namespace Civi\Lughauth\Features\Access\Oidc\Mfa\Domain\Gateway;

use Psr\Container\ContainerInterface;
use Civi\Lughauth\Features\Access\Oidc\Mfa\Domain\PublicLoginMfaBuildResponse;
use Civi\Lughauth\Features\Access\Oidc\Mfa\Infrastructure\Driven\UserMfaAdapter;

class UserMfaGateway
{
    private readonly UserMfaRepository $repository;
    public function __construct(ContainerInterface $container, ?UserMfaRepository $repository = null)
    {
        $this->repository = $repository ?? $container->get(UserMfaAdapter::class);
    }
    public function configurationForNewMfa(string $tenant, string $username): PublicLoginMfaBuildResponse
    {
        return $this->repository->configurationForNewMfa($tenant, $username);
    }
    public function verifyOtp(string $tenant, string $username, string $otp): bool
    {
        return $this->repository->verifyOtp($tenant, $username, $otp);
    }
    public function verifyNewOpt(string $tenant, string $username, string $seed, string $otp): bool
    {
        return $this->repository->verifyNewOpt($tenant, $username, $seed, $otp);
    }
    public function storeSeed(string $tenant, string $username, string $seed): void
    {
        $this->repository->storeSeed($tenant, $username, $seed);
    }
}
