<?php

/* @autogenerated */
declare(strict_types=1);

namespace Civi\Lughauth\Features\Access\Oidc\Authentication\Application\TokenGranter;

use Civi\Lughauth\Features\Access\Oidc\Authentication\Domain\AuthenticationRequest;
use Civi\Lughauth\Features\Access\Oidc\Authentication\Domain\AuthenticationResult;

class TokenGranterMediator
{
    private readonly array $granters;
    public function __construct(ResolverForPassword $passResolver, ResolverForRefresh $refreshResolver)
    {
        $this->granters = [ $passResolver, $refreshResolver ];
    }

    public function autenticate(
        string $grantType,
        string $tenant,
        AuthenticationRequest $client,
        array $params
    ): ?AuthenticationResult {
        foreach ($this->granters as $granter) {
            if ($granter->canHandle($grantType, $params)) {
                return $granter->autenticate($tenant, $client, $params);
            }
        }
        return null;
    }
}
