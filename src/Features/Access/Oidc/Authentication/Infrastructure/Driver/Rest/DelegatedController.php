<?php

/* @autogenerated */
declare(strict_types=1);

namespace Civi\Lughauth\Features\Access\Oidc\Authentication\Infrastructure\Driver\Rest;

use Psr\Http\Message\ResponseInterface;
use Psr\Http\Message\ServerRequestInterface;
use Civi\Lughauth\Shared\Context;
use Civi\Lughauth\Features\Access\Oidc\DelegateLogin\Application\DelegateLogin;

class DelegatedController
{
    public function __construct(private readonly Context $context, private readonly DelegateLogin $delegated)
    {
    }

    public function verify(ServerRequestInterface $request, ResponseInterface $response, array $args): ResponseInterface
    {
        return $this->delegated->redirectToTenant('/oauth/openid/', '/authorize', $request, $response);
    }
}
