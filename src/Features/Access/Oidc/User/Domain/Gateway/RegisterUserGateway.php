<?php

/* @autogenerated */
declare(strict_types=1);

namespace Civi\Lughauth\Features\Access\Oidc\User\Domain\Gateway;

use Psr\Container\ContainerInterface;
use Civi\Lughauth\Features\Access\Oidc\User\Infrastructure\Driven\RegisterUserAdapter;

class RegisterUserGateway
{
    private readonly RegisterUserRepository $repository;
    public function __construct(ContainerInterface $container, ?RegisterUserRepository $repository = null)
    {
        $this->repository = $repository ?? $container->get(RegisterUserAdapter::class);
    }
    public function allowRegister(string $tenant): bool
    {
        return $this->repository->allowRegister($tenant);
    }

    public function getRegisterConsent(string $tenant): ?string
    {
        return $this->repository->getRegisterConsent($tenant);
    }

    public function requestForRegister(string $url, string $tenant, string $email, string $password)
    {
        $this->repository->requestForRegister($url, $tenant, $email, $password);
    }

    public function verifyRegister(string $tenant, string $code): ?string
    {
        return $this->repository->verifyRegister($tenant, $code);
    }
}
