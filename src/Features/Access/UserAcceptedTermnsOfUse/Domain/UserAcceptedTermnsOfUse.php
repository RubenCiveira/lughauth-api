<?php

# @autogenerated
declare(strict_types=1);

namespace Civi\Lughauth\Features\Access\UserAcceptedTermnsOfUse\Domain;

use Civi\Lughauth\Features\Access\UserAcceptedTermnsOfUse\Domain\ValueObject\UserAcceptedTermnsOfUseUidVO;
use Civi\Lughauth\Features\Access\UserAcceptedTermnsOfUse\Domain\ValueObject\UserAcceptedTermnsOfUseUserVO;
use Civi\Lughauth\Features\Access\UserAcceptedTermnsOfUse\Domain\ValueObject\Accesor\UserAcceptedTermnsOfUseUserAccesor;
use Civi\Lughauth\Features\Access\UserAcceptedTermnsOfUse\Domain\ValueObject\UserAcceptedTermnsOfUseConditionsVO;
use Civi\Lughauth\Features\Access\UserAcceptedTermnsOfUse\Domain\ValueObject\Accesor\UserAcceptedTermnsOfUseConditionsAccesor;
use Civi\Lughauth\Features\Access\UserAcceptedTermnsOfUse\Domain\ValueObject\UserAcceptedTermnsOfUseAcceptDateVO;
use Civi\Lughauth\Features\Access\UserAcceptedTermnsOfUse\Domain\ValueObject\Accesor\UserAcceptedTermnsOfUseAcceptDateAccesor;
use Civi\Lughauth\Features\Access\UserAcceptedTermnsOfUse\Domain\ValueObject\UserAcceptedTermnsOfUseVersionVO;
use Civi\Lughauth\Features\Access\UserAcceptedTermnsOfUse\Domain\ValueObject\Accesor\UserAcceptedTermnsOfUseVersionAccesor;
use Civi\Lughauth\Features\Access\UserAcceptedTermnsOfUse\Domain\Event\UserAcceptedTermnsOfUseCreateEvent;
use Civi\Lughauth\Features\Access\UserAcceptedTermnsOfUse\Domain\Event\UserAcceptedTermnsOfUseUpdateEvent;
use Civi\Lughauth\Features\Access\UserAcceptedTermnsOfUse\Domain\Event\UserAcceptedTermnsOfUseDeleteEvent;
use Civi\Lughauth\Features\Access\User\Domain\UserRef;
use Civi\Lughauth\Features\Access\TenantTermsOfUse\Domain\TenantTermsOfUseRef;

class UserAcceptedTermnsOfUse extends UserAcceptedTermnsOfUseRef
{
    use UserAcceptedTermnsOfUseUserAccesor;
    use UserAcceptedTermnsOfUseConditionsAccesor;
    use UserAcceptedTermnsOfUseAcceptDateAccesor;
    use UserAcceptedTermnsOfUseVersionAccesor;
    private array $recordedEvents = [];

    public function __construct(
        UserAcceptedTermnsOfUseUidVO|string $uid,
        UserAcceptedTermnsOfUseUserVO|UserRef $user,
        UserAcceptedTermnsOfUseConditionsVO|TenantTermsOfUseRef $conditions,
        UserAcceptedTermnsOfUseAcceptDateVO|\DateTimeImmutable|null $acceptDate = null,
        UserAcceptedTermnsOfUseVersionVO|int|null $version = null,
    ) {
        parent::__construct($uid);
        $this->_user = UserAcceptedTermnsOfUseUserVO::from($user);
        $this->_conditions = UserAcceptedTermnsOfUseConditionsVO::from($conditions);
        $this->_acceptDate = null === $acceptDate ? UserAcceptedTermnsOfUseAcceptDateVO::empty() : UserAcceptedTermnsOfUseAcceptDateVO::from($acceptDate);
        $this->_version = null === $version ? UserAcceptedTermnsOfUseVersionVO::empty() : UserAcceptedTermnsOfUseVersionVO::from($version);
    }
    public function replace(UserAcceptedTermnsOfUseAttributes $values): UserAcceptedTermnsOfUse
    {
        $value = clone $this;
        $value->_user = $values->getUserOrDefault($this->_user);
        $value->_conditions = $values->getConditionsOrDefault($this->_conditions);
        $value->_acceptDate = $values->getAcceptDateOrDefault($this->_acceptDate);
        $value->_version = $values->getVersionOrDefault($this->_version);
        return $value;
    }
    public static function calculatedFields(): array
    {
        return [];
    }
    public static function create(UserAcceptedTermnsOfUseAttributes $values): UserAcceptedTermnsOfUse
    {
        $value = $values->build();
        $value->recordedEvents[] = new UserAcceptedTermnsOfUseCreateEvent($value);
        return $value;
    }
    public function update(UserAcceptedTermnsOfUseAttributes $values): UserAcceptedTermnsOfUse
    {
        $value = $this->replace($values);
        $value->recordedEvents[] = new UserAcceptedTermnsOfUseUpdateEvent($value, $this);
        return $value;
    }
    public function delete(): UserAcceptedTermnsOfUse
    {
        $value = clone $this;
        $value->recordedEvents[] = new UserAcceptedTermnsOfUseDeleteEvent($value);
        return $value;
    }
    public function asPublicJson(): array
    {
        $data = [];
        $data['uid'] = $this->uid();
        $user = $this->getUser()?->uid();
        if ($user) {
            $data['user'] = ['$ref' => $user];
        }
        $conditions = $this->getConditions()?->uid();
        if ($conditions) {
            $data['conditions'] = ['$ref' => $conditions];
        }
        $data['acceptDate'] = $this->getAcceptDate();
        $data['version'] = $this->getVersion();
        return $data;
    }
    public function toAttributes(): UserAcceptedTermnsOfUseAttributes
    {
        return (new UserAcceptedTermnsOfUseAttributes())
          ->uid($this->uid())
          ->user($this->_user)
          ->conditions($this->_conditions)
          ->acceptDate($this->_acceptDate)
          ->version($this->_version);
    }
    public function getTheEvents(): array
    {
        return [...$this->recordedEvents];
    }
}
