<?php

# @autogenerated
declare(strict_types=1);

namespace Civi\Lughauth\Features\Access\TenantConfig\Infrastructure\Driver;

use Override;
use Slim\Routing\RouteCollectorProxy;
use Civi\Lughauth\Features\Access\TenantConfig\Infrastructure\Driver\Rest\TenantConfigAllowController;
use Civi\Lughauth\Features\Access\TenantConfig\Infrastructure\Driver\Rest\TenantConfigListController;
use Civi\Lughauth\Features\Access\TenantConfig\Infrastructure\Driver\Rest\TenantConfigCreateController;
use Civi\Lughauth\Features\Access\TenantConfig\Infrastructure\Driver\Rest\TenantConfigRetrieveController;
use Civi\Lughauth\Features\Access\TenantConfig\Infrastructure\Driver\Rest\TenantConfigUpdateController;
use Civi\Lughauth\Features\Access\TenantConfig\Infrastructure\Driver\Rest\TenantConfigDeleteController;
use Civi\Lughauth\Shared\Infrastructure\MicroPlugin;
use Civi\Lughauth\Shared\Event\EventListenersRegistrarInterface;
use Civi\Lughauth\Features\Access\TenantConfig\Application\Service\Visibility\TenantConfigFilterProposal;
use Civi\Lughauth\Features\Access\TenantConfig\Application\Policy\Filter\TenantAccesible;
use Civi\Lughauth\Features\Access\TenantConfig\Application\Policy\Fields\TenantConfigExcludingdRoot;
use Civi\Lughauth\Features\Access\TenantConfig\Application\Service\Visibility\TenantConfigFixedFieldsProposal;
use Civi\Lughauth\Features\Access\TenantConfig\Application\Policy\Allow\Create\IsAutenticatedCreateAllow;
use Civi\Lughauth\Features\Access\TenantConfig\Application\Usecase\Create\TenantConfigCreateAllowProposal;
use Civi\Lughauth\Features\Access\TenantConfig\Application\Policy\Allow\Update\IsAutenticatedUpdateAllow;
use Civi\Lughauth\Features\Access\TenantConfig\Application\Usecase\Update\TenantConfigUpdateAllowProposal;
use Civi\Lughauth\Features\Access\TenantConfig\Application\Policy\Allow\Retrieve\IsAutenticatedRetrieveAllow;
use Civi\Lughauth\Features\Access\TenantConfig\Application\Usecase\Retrieve\TenantConfigRetrieveAllowProposal;
use Civi\Lughauth\Features\Access\TenantConfig\Application\Policy\Allow\List\IsAutenticatedListAllow;
use Civi\Lughauth\Features\Access\TenantConfig\Application\Usecase\List\TenantConfigListAllowProposal;
use Civi\Lughauth\Features\Access\TenantConfig\Application\Policy\Allow\Delete\IsAutenticatedDeleteAllow;
use Civi\Lughauth\Features\Access\TenantConfig\Application\Usecase\Delete\TenantConfigDeleteAllowProposal;

class TenantConfigPlugin extends MicroPlugin
{
    #[Override]
    public function registerRoutes(RouteCollectorProxy $app)
    {
        $app->group('/api/access/tenants-config', [$this, 'setRoutesForTenantConfig']);
        $app->group('/api/me/acl/access/tenants-config', [$this, 'setRoutesForTenantConfigAcl']);
    }
    #[Override]
    public function registerEvents(EventListenersRegistrarInterface $bus)
    {
        $bus->registerListener(TenantConfigFilterProposal::class, TenantAccesible::class);
        $bus->registerListener(TenantConfigFixedFieldsProposal::class, TenantConfigExcludingdRoot::class);
        $bus->registerListener(TenantConfigCreateAllowProposal::class, IsAutenticatedCreateAllow::class);
        $bus->registerListener(TenantConfigUpdateAllowProposal::class, IsAutenticatedUpdateAllow::class);
        $bus->registerListener(TenantConfigRetrieveAllowProposal::class, IsAutenticatedRetrieveAllow::class);
        $bus->registerListener(TenantConfigListAllowProposal::class, IsAutenticatedListAllow::class);
        $bus->registerListener(TenantConfigDeleteAllowProposal::class, IsAutenticatedDeleteAllow::class);
    }
    public function setRoutesForTenantConfigAcl(RouteCollectorProxy $tenantConfigGroup)
    {
        $tenantConfigGroup->get('', [TenantConfigAllowController::class, 'genericAllow']);
        $tenantConfigGroup->get('/{uid}', [TenantConfigAllowController::class, 'contextualAllow']);
    }
    public function setRoutesForTenantConfig(RouteCollectorProxy $tenantConfigGroup)
    {
        $tenantConfigGroup->get('', [TenantConfigListController::class, 'list']);
        $tenantConfigGroup->post('', [TenantConfigCreateController::class, 'create']);
        $tenantConfigGroup->get('/{uid}', [TenantConfigRetrieveController::class, 'retrieve']);
        $tenantConfigGroup->put('/{uid}', [TenantConfigUpdateController::class, 'update']);
        $tenantConfigGroup->delete('/{uid}', [TenantConfigDeleteController::class, 'delete']);
        $tenantConfigGroup->delete('', [TenantConfigDeleteController::class, 'deleteAllForQuery']);
        $tenantConfigGroup->get('/~/delete-status/{uid}', [TenantConfigDeleteController::class, 'checkDeleteAllForQueryStatus']);
    }
}
