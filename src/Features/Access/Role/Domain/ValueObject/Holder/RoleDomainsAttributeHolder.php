<?php

# @autogenerated
declare(strict_types=1);

namespace Civi\Lughauth\Features\Access\Role\Domain\ValueObject\Holder;

use Civi\Lughauth\Shared\Value\Validation\ConstraintFailList;
use Civi\Lughauth\Features\Access\Role\Domain\ValueObject\RoleDomainsVO;
use Civi\Lughauth\Features\Access\Role\Domain\ValueObject\RoleDomainsListRef;

trait RoleDomainsAttributeHolder
{
    protected RoleDomainsVO|RoleDomainsListRef| array |null $domains = null;
    protected bool $domainsAssigned = false;

    public function getDomainsOrDefault(?RoleDomainsVO $domains): ?RoleDomainsVO
    {
        if ($this->domainsAssigned && $domains) {
            return RoleDomainsVO::from($this->domains)->getWithDefaults($domains);
        } elseif ($this->domainsAssigned) {
            return RoleDomainsVO::from($this->domains);
        } else {
            return $domains;
        }
    }
    public function domains(RoleDomainsVO|RoleDomainsListRef| array |null $domains): static
    {
        $this->domains = $domains;
        $this->domainsAssigned = true;
        return $this;
    }
    public function getDomains(): ?RoleDomainsListRef
    {
        return is_a($this->domains, RoleDomainsVO::class) ? $this->domains->value() : $this->domains;
    }
    public function unsetDomains(): static
    {
        $this->domains = null;
        $this->domainsAssigned = false;
        return $this;
    }
    protected function withDefaultDomains(): void
    {
    }
    protected function withAssertedDomainsRules(self $value, ConstraintFailList $errorsList): void
    {
        if ($value->domainsAssigned = $this->domainsAssigned) {
            $value->domains = RoleDomainsVO::tryFrom($this->domains, $errorsList);
        }
    }
}
