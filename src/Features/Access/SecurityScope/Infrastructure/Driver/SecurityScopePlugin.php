<?php

# @autogenerated
declare(strict_types=1);

namespace Civi\Lughauth\Features\Access\SecurityScope\Infrastructure\Driver;

use Override;
use Slim\Routing\RouteCollectorProxy;
use Civi\Lughauth\Features\Access\SecurityScope\Infrastructure\Driver\Rest\SecurityScopeAllowController;
use Civi\Lughauth\Features\Access\SecurityScope\Infrastructure\Driver\Rest\SecurityScopeListController;
use Civi\Lughauth\Features\Access\SecurityScope\Infrastructure\Driver\Rest\SecurityScopeCreateController;
use Civi\Lughauth\Features\Access\SecurityScope\Infrastructure\Driver\Rest\SecurityScopeRetrieveController;
use Civi\Lughauth\Features\Access\SecurityScope\Infrastructure\Driver\Rest\SecurityScopeUpdateController;
use Civi\Lughauth\Features\Access\SecurityScope\Infrastructure\Driver\Rest\SecurityScopeDeleteController;
use Civi\Lughauth\Features\Access\SecurityScope\Infrastructure\Driver\Rest\SecurityScopeDisableController;
use Civi\Lughauth\Features\Access\SecurityScope\Infrastructure\Driver\Rest\SecurityScopeEnableController;
use Civi\Lughauth\Shared\Infrastructure\MicroPlugin;
use Civi\Lughauth\Shared\Event\EventListenersRegistrarInterface;
use Civi\Lughauth\Features\Access\SecurityScope\Application\Policy\Allow\Create\IsAutenticatedCreateAllow;
use Civi\Lughauth\Features\Access\SecurityScope\Application\Policy\Allow\Update\IsAutenticatedUpdateAllow;
use Civi\Lughauth\Features\Access\SecurityScope\Application\Policy\Allow\Retrieve\IsAutenticatedRetrieveAllow;
use Civi\Lughauth\Features\Access\SecurityScope\Application\Policy\Allow\List\IsAutenticatedListAllow;
use Civi\Lughauth\Features\Access\SecurityScope\Application\Policy\Allow\Delete\IsAutenticatedDeleteAllow;
use Civi\Lughauth\Features\Access\SecurityScope\Application\Policy\Allow\Disable\IsAutenticatedDisableAllow;
use Civi\Lughauth\Features\Access\SecurityScope\Application\Policy\Allow\Enable\IsAutenticatedEnableAllow;
use Civi\Lughauth\Features\Access\SecurityScope\Application\Usecase\Create\SecurityScopeCreateAllowDecision;
use Civi\Lughauth\Features\Access\SecurityScope\Application\Usecase\Update\SecurityScopeUpdateAllowDecision;
use Civi\Lughauth\Features\Access\SecurityScope\Application\Usecase\Retrieve\SecurityScopeRetrieveAllowDecision;
use Civi\Lughauth\Features\Access\SecurityScope\Application\Usecase\List\SecurityScopeListAllowDecision;
use Civi\Lughauth\Features\Access\SecurityScope\Application\Usecase\Delete\SecurityScopeDeleteAllowDecision;
use Civi\Lughauth\Features\Access\SecurityScope\Application\Usecase\Disable\SecurityScopeDisableAllowDecision;
use Civi\Lughauth\Features\Access\SecurityScope\Application\Usecase\Enable\SecurityScopeEnableAllowDecision;

class SecurityScopePlugin extends MicroPlugin
{
    #[Override]
    public function registerRoutes(RouteCollectorProxy $app)
    {
        $app->group('/api/access/security-scopes', [$this, 'setRoutesForSecurityScope']);
        $app->group('/api/me/acl/access/security-scopes', [$this, 'setRoutesForSecurityScopeAcl']);
    }
    #[Override]
    public function registerEvents(EventListenersRegistrarInterface $bus)
    {
        $bus->registerListener(SecurityScopeCreateAllowDecision::class, IsAutenticatedCreateAllow::class);
        $bus->registerListener(SecurityScopeUpdateAllowDecision::class, IsAutenticatedUpdateAllow::class);
        $bus->registerListener(SecurityScopeRetrieveAllowDecision::class, IsAutenticatedRetrieveAllow::class);
        $bus->registerListener(SecurityScopeListAllowDecision::class, IsAutenticatedListAllow::class);
        $bus->registerListener(SecurityScopeDeleteAllowDecision::class, IsAutenticatedDeleteAllow::class);
        $bus->registerListener(SecurityScopeDisableAllowDecision::class, IsAutenticatedDisableAllow::class);
        $bus->registerListener(SecurityScopeEnableAllowDecision::class, IsAutenticatedEnableAllow::class);
    }
    public function setRoutesForSecurityScopeAcl(RouteCollectorProxy $securityScopeGroup)
    {
        $securityScopeGroup->get('', [SecurityScopeAllowController::class, 'genericAllow']);
        $securityScopeGroup->get('/{uid}', [SecurityScopeAllowController::class, 'contextualAllow']);
    }
    public function setRoutesForSecurityScope(RouteCollectorProxy $securityScopeGroup)
    {
        $securityScopeGroup->get('', [SecurityScopeListController::class, 'list']);
        $securityScopeGroup->post('', [SecurityScopeCreateController::class, 'create']);
        $securityScopeGroup->get('/{uid}', [SecurityScopeRetrieveController::class, 'retrieve']);
        $securityScopeGroup->put('/{uid}', [SecurityScopeUpdateController::class, 'update']);
        $securityScopeGroup->delete('/{uid}', [SecurityScopeDeleteController::class, 'delete']);
        $securityScopeGroup->delete('', [SecurityScopeDeleteController::class, 'deleteAllForQuery']);
        $securityScopeGroup->get('/~/delete-status/{uid}', [SecurityScopeDeleteController::class, 'checkDeleteAllForQueryStatus']);
        $securityScopeGroup->patch('/~/disable', [SecurityScopeDisableController::class, 'disableAllForQuery']);
        $securityScopeGroup->patch('/{uid}/disable', [SecurityScopeDisableController::class, 'disable']);
        $securityScopeGroup->get('/~/disable-status/{uid}', [SecurityScopeDisableController::class, 'checkDisableAllForQueryStatus']);
        $securityScopeGroup->patch('/~/enable', [SecurityScopeEnableController::class, 'enableAllForQuery']);
        $securityScopeGroup->patch('/{uid}/enable', [SecurityScopeEnableController::class, 'enable']);
        $securityScopeGroup->get('/~/enable-status/{uid}', [SecurityScopeEnableController::class, 'checkEnableAllForQueryStatus']);
    }
}
