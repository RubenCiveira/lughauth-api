<?php

# @autogenerated
declare(strict_types=1);

namespace Civi\Lughauth\Features\Access\TrustedClient\Domain\ValueObject\Accesor;

use Civi\Lughauth\Features\Access\TrustedClient\Domain\ValueObject\TrustedClientSecretOauthVO;
use Civi\Lughauth\Shared\Security\AesCypherService;

trait TrustedClientSecretOauthAccesor
{
    private ?TrustedClientSecretOauthVO $_secretOauth = null;
    public function getSecretOauth(): ?string
    {
        return $this->_secretOauth?->value();
    }
    public function secretOauth(): ?TrustedClientSecretOauthVO
    {
        return $this->_secretOauth;
    }
    public function getCypheredSecretOauth(AesCypherService $cypher): ?string
    {
        return $this->_secretOauth?->cypheredValueWith($cypher);
    }
    public function getPlainSecretOauth(AesCypherService $cypher): ?string
    {
        return $this->_secretOauth?->plainValueWith($cypher);
    }
    public function isSecretOauthChanged(?self $original = null): bool
    {
        return $this->_secretOauth->value() !== ($original ? $original->_secretOauth->value() : null);
    }
    public function withSecretOauth(TrustedClientSecretOauthVO|string|null $secretOauth): self
    {
        $copy = clone $this;
        $copy->_secretOauth = TrustedClientSecretOauthVO::from($secretOauth);
        return $copy;
    }
}
