<?php

# @autogenerated
declare(strict_types=1);

namespace Civi\Lughauth\Features\Access\TenantPartySecurity\Infrastructure\Driver\Batch;

use Override;
use Civi\Lughauth\Shared\Infrastructure\LongTask\TaskContext;
use Civi\Lughauth\Shared\Infrastructure\LongTask\TaskReaderInterface;
use Civi\Lughauth\Shared\Infrastructure\LongTask\TaskWriterInterface;
use Civi\Lughauth\Shared\Infrastructure\LongTask\TaskDescriptorInterface;
use Civi\Lughauth\Features\Access\TenantPartySecurity\Application\Usecase\Delete\TenantPartySecurityDeleteUsecase;

class TenantPartySecurityTaskDelete implements TaskDescriptorInterface
{
    public function __construct(
        private readonly TenantPartySecurityTaskReader $reader,
        private readonly TenantPartySecurityDeleteUsecase $usecase,
    ) {
    }

    #[Override]
    public function process(TaskContext $context, mixed $item): mixed
    {
        /** @var $item TenantAttributes */
        $this->usecase->delete($item->getUid());
        return $item;
    }

    #[Override]
    public function init(TaskContext $initial): TaskContext
    {
        return $initial;
    }

    #[Override]
    public function finish(TaskContext $state)
    {
    }

    #[Override]
    public function describe(mixed $item): string
    {
        return $item->getUid();
    }

    #[Override]
    public function reader(): TaskReaderInterface
    {
        return $this->reader;
    }

    #[Override]
    public function writer(): ?TaskWriterInterface
    {
        return null;
    }
}
