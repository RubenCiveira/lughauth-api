<?php

# @autogenerated
declare(strict_types=1);

namespace Civi\Lughauth\Features\Access\TenantTermsOfUse\Domain;

use Civi\Lughauth\Features\Access\TenantTermsOfUse\Domain\ValueObject\TenantTermsOfUseUidVO;
use Civi\Lughauth\Features\Access\TenantTermsOfUse\Domain\ValueObject\TenantTermsOfUseTenantVO;
use Civi\Lughauth\Features\Access\TenantTermsOfUse\Domain\ValueObject\Accesor\TenantTermsOfUseTenantAccesor;
use Civi\Lughauth\Features\Access\TenantTermsOfUse\Domain\ValueObject\TenantTermsOfUseTextVO;
use Civi\Lughauth\Features\Access\TenantTermsOfUse\Domain\ValueObject\Accesor\TenantTermsOfUseTextAccesor;
use Civi\Lughauth\Features\Access\TenantTermsOfUse\Domain\ValueObject\TenantTermsOfUseAttachedVO;
use Civi\Lughauth\Features\Access\TenantTermsOfUse\Domain\ValueObject\Accesor\TenantTermsOfUseAttachedAccesor;
use Civi\Lughauth\Features\Access\TenantTermsOfUse\Domain\ValueObject\TenantTermsOfUseActivationDateVO;
use Civi\Lughauth\Features\Access\TenantTermsOfUse\Domain\ValueObject\Accesor\TenantTermsOfUseActivationDateAccesor;
use Civi\Lughauth\Features\Access\TenantTermsOfUse\Domain\ValueObject\TenantTermsOfUseVersionVO;
use Civi\Lughauth\Features\Access\TenantTermsOfUse\Domain\ValueObject\Accesor\TenantTermsOfUseVersionAccesor;
use Civi\Lughauth\Features\Access\TenantTermsOfUse\Domain\Event\TenantTermsOfUseCreateEvent;
use Civi\Lughauth\Features\Access\TenantTermsOfUse\Domain\Event\TenantTermsOfUseUpdateEvent;
use Civi\Lughauth\Features\Access\TenantTermsOfUse\Domain\Event\TenantTermsOfUseDeleteEvent;
use Civi\Lughauth\Features\Access\Tenant\Domain\TenantRef;
use Civi\Lughauth\Shared\Connector\FileStorage\FileStorageInterface;
use Civi\Lughauth\Shared\Connector\FileStorage\FileStoreKey;

class TenantTermsOfUse extends TenantTermsOfUseRef
{
    use TenantTermsOfUseTenantAccesor;
    use TenantTermsOfUseTextAccesor;
    use TenantTermsOfUseAttachedAccesor;
    use TenantTermsOfUseActivationDateAccesor;
    use TenantTermsOfUseVersionAccesor;
    private array $recordedEvents = [];

    public function __construct(
        TenantTermsOfUseUidVO|string $uid,
        TenantTermsOfUseTenantVO|TenantRef $tenant,
        TenantTermsOfUseTextVO|string $text,
        TenantTermsOfUseAttachedVO|string|null $attached = null,
        TenantTermsOfUseActivationDateVO|\DateTimeImmutable|null $activationDate = null,
        TenantTermsOfUseVersionVO|int|null $version = null,
    ) {
        parent::__construct($uid);
        $this->_tenant = TenantTermsOfUseTenantVO::from($tenant);
        $this->_text = TenantTermsOfUseTextVO::from($text);
        $this->_attached = null === $attached ? TenantTermsOfUseAttachedVO::empty() : TenantTermsOfUseAttachedVO::from($attached);
        $this->_activationDate = null === $activationDate ? TenantTermsOfUseActivationDateVO::empty() : TenantTermsOfUseActivationDateVO::from($activationDate);
        $this->_version = null === $version ? TenantTermsOfUseVersionVO::empty() : TenantTermsOfUseVersionVO::from($version);
    }
    public function replace(TenantTermsOfUseAttributes $values): TenantTermsOfUse
    {
        $value = clone $this;
        $value->_tenant = $values->getTenantOrDefault($this->_tenant);
        $value->_text = $values->getTextOrDefault($this->_text);
        $value->_attached = $values->getAttachedOrDefault($this->_attached);
        $value->_activationDate = $values->getActivationDateOrDefault($this->_activationDate);
        $value->_version = $values->getVersionOrDefault($this->_version);
        return $value;
    }
    public static function calculatedFields(): array
    {
        return [];
    }
    public static function create(TenantTermsOfUseAttributes $values): TenantTermsOfUse
    {
        $value = $values->build();
        $value->recordedEvents[] = new TenantTermsOfUseCreateEvent($value);
        return $value;
    }
    public function update(TenantTermsOfUseAttributes $values): TenantTermsOfUse
    {
        $value = $this->replace($values);
        $value->recordedEvents[] = new TenantTermsOfUseUpdateEvent($value);
        return $value;
    }
    public function delete(): TenantTermsOfUse
    {
        $value = clone $this;
        $value->recordedEvents[] = new TenantTermsOfUseDeleteEvent($value);
        return $value;
    }
    public function commitAttachedWith(FileStorageInterface $store)
    {
        $key = $store->commitContent(new FileStoreKey($this->getAttached()));
        $this->_attached = TenantTermsOfUseAttachedVO::fromStored($key->key);
    }
    public function toAttributes(): TenantTermsOfUseAttributes
    {
        return (new TenantTermsOfUseAttributes())
          ->uid($this->uid())
          ->tenant($this->_tenant)
          ->text($this->_text)
          ->attached($this->_attached)
          ->activationDate($this->_activationDate)
          ->version($this->_version);
    }
    public function getTheEvents(): array
    {
        return [...$this->recordedEvents];
    }
}
