<?php

# @autogenerated
declare(strict_types=1);

namespace Civi\Lughauth\Features\Access\UserIdentity\Domain;

use Civi\Lughauth\Features\Access\UserIdentity\Domain\ValueObject\Holder\UserIdentityUidAttributeHolder;
use Civi\Lughauth\Features\Access\UserIdentity\Domain\ValueObject\UserIdentityUidVO;
use Civi\Lughauth\Features\Access\UserIdentity\Domain\ValueObject\Holder\UserIdentityUserAttributeHolder;
use Civi\Lughauth\Features\Access\UserIdentity\Domain\ValueObject\UserIdentityUserVO;
use Civi\Lughauth\Features\Access\UserIdentity\Domain\ValueObject\Holder\UserIdentityRelyingPartyAttributeHolder;
use Civi\Lughauth\Features\Access\UserIdentity\Domain\ValueObject\UserIdentityRelyingPartyVO;
use Civi\Lughauth\Features\Access\UserIdentity\Domain\ValueObject\Holder\UserIdentityTrustedClientAttributeHolder;
use Civi\Lughauth\Features\Access\UserIdentity\Domain\ValueObject\UserIdentityTrustedClientVO;
use Civi\Lughauth\Features\Access\UserIdentity\Domain\ValueObject\Holder\UserIdentityRolesAttributeHolder;
use Civi\Lughauth\Features\Access\UserIdentity\Domain\ValueObject\UserIdentityRolesVO;
use Civi\Lughauth\Features\Access\UserIdentity\Domain\ValueObject\Holder\UserIdentityVersionAttributeHolder;
use Civi\Lughauth\Features\Access\UserIdentity\Domain\ValueObject\UserIdentityVersionVO;
use Civi\Lughauth\Shared\Value\Validation\ConstraintFailList;

class UserIdentityAttributes
{
    use UserIdentityUidAttributeHolder;
    use UserIdentityUserAttributeHolder;
    use UserIdentityRelyingPartyAttributeHolder;
    use UserIdentityTrustedClientAttributeHolder;
    use UserIdentityRolesAttributeHolder;
    use UserIdentityVersionAttributeHolder;

    private const UNSETS = [
      'uid' => 'unsetUid',
      'user' => 'unsetUser',
      'relyingParty' => 'unsetRelyingParty',
      'trustedClient' => 'unsetTrustedClient',
      'roles' => 'unsetRoles',
      'version' => 'unsetVersion',
    ];

    public function build(): UserIdentity
    {
        $errors = new ConstraintFailList();
        $uid = UserIdentityUidVO::tryFrom($this->uid, $errors);
        $user = UserIdentityUserVO::tryFrom($this->user, $errors);
        $relyingParty = UserIdentityRelyingPartyVO::tryFrom($this->relyingParty, $errors);
        $trustedClient = UserIdentityTrustedClientVO::tryFrom($this->trustedClient, $errors);
        $roles = UserIdentityRolesVO::tryFrom($this->roles, $errors);
        $version = UserIdentityVersionVO::tryFrom($this->version, $errors);
        if ($errors->hasErrors()) {
            throw $errors->asConstraintException();
        }    return new UserIdentity(
            uid: $uid,
            user: $user,
            relyingParty: $relyingParty,
            trustedClient: $trustedClient,
            roles: $roles,
            version: $version,
        );
    }
    public function withAssertedRules(): UserIdentityAttributes
    {
        $value = new UserIdentityAttributes();
        $errorsList = new ConstraintFailList();
        $this->withAssertedUidRules($value, $errorsList);
        $this->withAssertedUserRules($value, $errorsList);
        $this->withAssertedRelyingPartyRules($value, $errorsList);
        $this->withAssertedTrustedClientRules($value, $errorsList);
        $this->withAssertedRolesRules($value, $errorsList);
        $this->withAssertedVersionRules($value, $errorsList);
        if ($errorsList->hasErrors()) {
            throw $errorsList->asConstraintException();
        }
        return $value;
    }
    public function unset($field)
    {
        if (isset(self::UNSETS[$field])) {
            call_user_func([$this, self::UNSETS[$field]]);
        }
    }
    public function withDefaults(): UserIdentityAttributes
    {
        $this->withDefaultUid();
        $this->withDefaultUser();
        $this->withDefaultRelyingParty();
        $this->withDefaultTrustedClient();
        $this->withDefaultRoles();
        $this->withDefaultVersion();
        return $this;
    }
}
