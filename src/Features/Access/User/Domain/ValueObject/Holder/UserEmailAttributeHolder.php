<?php

# @autogenerated
declare(strict_types=1);

namespace Civi\Lughauth\Features\Access\User\Domain\ValueObject\Holder;

use Civi\Lughauth\Shared\Value\Validation\ConstraintFailList;
use Civi\Lughauth\Features\Access\User\Domain\ValueObject\UserEmailVO;

trait UserEmailAttributeHolder
{
    protected UserEmailVO|string|null $email = null;
    protected bool $emailAssigned = false;

    public function getEmailOrDefault(?UserEmailVO $email): ?UserEmailVO
    {
        return $this->emailAssigned ? ($this->email !== null ? UserEmailVO::from($this->email) : null) : $email;
    }
    public function email(UserEmailVO|string|null $email): static
    {
        $this->email = $email;
        $this->emailAssigned = true;
        return $this;
    }
    public function getEmail(): ?string
    {
        return is_a($this->email, UserEmailVO::class) ? $this->email->value() : $this->email;
    }
    public function unsetEmail(): static
    {
        $this->email = null;
        $this->emailAssigned = false;
        return $this;
    }
    protected function withDefaultEmail(): void
    {
    }
    protected function withAssertedEmailRules(self $value, ConstraintFailList $errorsList): void
    {
        if ($value->emailAssigned = $this->emailAssigned) {
            $value->email = UserEmailVO::tryFrom($this->email, $errorsList);
        }
    }
}
