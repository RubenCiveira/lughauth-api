<?php

# @autogenerated
declare(strict_types=1);

namespace Civi\Lughauth\Features\Access\User\Domain\ValueObject\Holder;

use Civi\Lughauth\Shared\Value\Validation\ConstraintFailList;
use Civi\Lughauth\Features\Access\User\Domain\ValueObject\UserProviderVO;

trait UserProviderAttributeHolder
{
    protected UserProviderVO|string|null $provider = null;
    protected bool $providerAssigned = false;

    public function getProviderOrDefault(?UserProviderVO $provider): ?UserProviderVO
    {
        return $this->providerAssigned ? ($this->provider !== null ? UserProviderVO::from($this->provider) : null) : $provider;
    }
    public function provider(UserProviderVO|string|null $provider): static
    {
        $this->provider = $provider;
        $this->providerAssigned = true;
        return $this;
    }
    public function getProvider(): ?string
    {
        return is_a($this->provider, UserProviderVO::class) ? $this->provider->value() : $this->provider;
    }
    public function unsetProvider(): static
    {
        $this->provider = null;
        $this->providerAssigned = false;
        return $this;
    }
    protected function withDefaultProvider(): void
    {
    }
    protected function withAssertedProviderRules(self $value, ConstraintFailList $errorsList): void
    {
        if ($value->providerAssigned = $this->providerAssigned) {
            $value->provider = UserProviderVO::tryFrom($this->provider, $errorsList);
        }
    }
}
