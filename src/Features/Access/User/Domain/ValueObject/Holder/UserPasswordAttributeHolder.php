<?php

# @autogenerated
declare(strict_types=1);

namespace Civi\Lughauth\Features\Access\User\Domain\ValueObject\Holder;

use Civi\Lughauth\Shared\Value\Validation\ConstraintFailList;
use Civi\Lughauth\Features\Access\User\Domain\ValueObject\UserPasswordVO;

trait UserPasswordAttributeHolder
{
    protected UserPasswordVO|string|null $password = null;
    protected bool $passwordAssigned = false;

    public function getPasswordOrDefault(?UserPasswordVO $password): ?UserPasswordVO
    {
        return $this->passwordAssigned ? ($this->password !== null ? UserPasswordVO::from($this->password) : null) : $password;
    }
    public function password(UserPasswordVO|string|null $password): static
    {
        $this->password = $password;
        $this->passwordAssigned = true;
        return $this;
    }
    public function getPassword(): ?string
    {
        return is_a($this->password, UserPasswordVO::class) ? $this->password->value() : $this->password;
    }
    public function unsetPassword(): static
    {
        $this->password = null;
        $this->passwordAssigned = false;
        return $this;
    }
    protected function withDefaultPassword(): void
    {
    }
    protected function withAssertedPasswordRules(self $value, ConstraintFailList $errorsList): void
    {
        if ($value->passwordAssigned = $this->passwordAssigned) {
            $value->password = UserPasswordVO::tryFrom($this->password, $errorsList);
        }
    }
}
