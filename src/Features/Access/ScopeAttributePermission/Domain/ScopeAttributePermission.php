<?php

# @autogenerated
declare(strict_types=1);

namespace Civi\Lughauth\Features\Access\ScopeAttributePermission\Domain;

use Civi\Lughauth\Features\Access\ScopeAttributePermission\Domain\ValueObject\ScopeAttributePermissionUidVO;
use Civi\Lughauth\Features\Access\ScopeAttributePermission\Domain\ValueObject\ScopeAttributePermissionSecurityDomainVO;
use Civi\Lughauth\Features\Access\ScopeAttributePermission\Domain\ValueObject\Accesor\ScopeAttributePermissionSecurityDomainAccesor;
use Civi\Lughauth\Features\Access\ScopeAttributePermission\Domain\ValueObject\ScopeAttributePermissionSecurityAttributeVO;
use Civi\Lughauth\Features\Access\ScopeAttributePermission\Domain\ValueObject\Accesor\ScopeAttributePermissionSecurityAttributeAccesor;
use Civi\Lughauth\Features\Access\ScopeAttributePermission\Domain\ValueObject\ScopeAttributePermissionPermisionVO;
use Civi\Lughauth\Features\Access\ScopeAttributePermission\Domain\ValueObject\Accesor\ScopeAttributePermissionPermisionAccesor;
use Civi\Lughauth\Features\Access\ScopeAttributePermission\Domain\ValueObject\ScopeAttributePermissionVersionVO;
use Civi\Lughauth\Features\Access\ScopeAttributePermission\Domain\ValueObject\Accesor\ScopeAttributePermissionVersionAccesor;
use Civi\Lughauth\Features\Access\ScopeAttributePermission\Domain\Event\ScopeAttributePermissionCreateEvent;
use Civi\Lughauth\Features\Access\ScopeAttributePermission\Domain\Event\ScopeAttributePermissionUpdateEvent;
use Civi\Lughauth\Features\Access\ScopeAttributePermission\Domain\Event\ScopeAttributePermissionDeleteEvent;
use Civi\Lughauth\Features\Access\SecurityDomain\Domain\SecurityDomainRef;
use Civi\Lughauth\Features\Access\SecurityAttribute\Domain\SecurityAttributeRef;

class ScopeAttributePermission extends ScopeAttributePermissionRef
{
    use ScopeAttributePermissionSecurityDomainAccesor;
    use ScopeAttributePermissionSecurityAttributeAccesor;
    use ScopeAttributePermissionPermisionAccesor;
    use ScopeAttributePermissionVersionAccesor;
    private array $recordedEvents = [];

    public function __construct(
        ScopeAttributePermissionUidVO|string $uid,
        ScopeAttributePermissionSecurityDomainVO|SecurityDomainRef $securityDomain,
        ScopeAttributePermissionSecurityAttributeVO|SecurityAttributeRef $securityAttribute,
        ScopeAttributePermissionPermisionVO|string $permision,
        ScopeAttributePermissionVersionVO|int|null $version = null,
    ) {
        parent::__construct($uid);
        $this->_securityDomain = ScopeAttributePermissionSecurityDomainVO::from($securityDomain);
        $this->_securityAttribute = ScopeAttributePermissionSecurityAttributeVO::from($securityAttribute);
        $this->_permision = ScopeAttributePermissionPermisionVO::from($permision);
        $this->_version = null === $version ? ScopeAttributePermissionVersionVO::empty() : ScopeAttributePermissionVersionVO::from($version);
    }
    public function replace(ScopeAttributePermissionAttributes $values): ScopeAttributePermission
    {
        $value = clone $this;
        $value->_securityDomain = $values->getSecurityDomainOrDefault($this->_securityDomain);
        $value->_securityAttribute = $values->getSecurityAttributeOrDefault($this->_securityAttribute);
        $value->_permision = $values->getPermisionOrDefault($this->_permision);
        $value->_version = $values->getVersionOrDefault($this->_version);
        return $value;
    }
    public static function calculatedFields(): array
    {
        return [];
    }
    public static function create(ScopeAttributePermissionAttributes $values): ScopeAttributePermission
    {
        $value = $values->build();
        $value->recordedEvents[] = new ScopeAttributePermissionCreateEvent($value);
        return $value;
    }
    public function update(ScopeAttributePermissionAttributes $values): ScopeAttributePermission
    {
        $value = $this->replace($values);
        $value->recordedEvents[] = new ScopeAttributePermissionUpdateEvent($value);
        return $value;
    }
    public function delete(): ScopeAttributePermission
    {
        $value = clone $this;
        $value->recordedEvents[] = new ScopeAttributePermissionDeleteEvent($value);
        return $value;
    }
    public function toAttributes(): ScopeAttributePermissionAttributes
    {
        return (new ScopeAttributePermissionAttributes())
          ->uid($this->uid())
          ->securityDomain($this->_securityDomain)
          ->securityAttribute($this->_securityAttribute)
          ->permision($this->_permision)
          ->version($this->_version);
    }
    public function getTheEvents(): array
    {
        return [...$this->recordedEvents];
    }
}
