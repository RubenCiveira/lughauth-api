<?php

# @autogenerated
declare(strict_types=1);

namespace Civi\Lughauth\Features\Access\ScopeAttributePermission\Infrastructure\Driver;

use Override;
use Slim\Routing\RouteCollectorProxy;
use Civi\Lughauth\Features\Access\ScopeAttributePermission\Infrastructure\Driver\Rest\ScopeAttributePermissionAllowController;
use Civi\Lughauth\Features\Access\ScopeAttributePermission\Infrastructure\Driver\Rest\ScopeAttributePermissionListController;
use Civi\Lughauth\Features\Access\ScopeAttributePermission\Infrastructure\Driver\Rest\ScopeAttributePermissionCreateController;
use Civi\Lughauth\Features\Access\ScopeAttributePermission\Infrastructure\Driver\Rest\ScopeAttributePermissionRetrieveController;
use Civi\Lughauth\Features\Access\ScopeAttributePermission\Infrastructure\Driver\Rest\ScopeAttributePermissionUpdateController;
use Civi\Lughauth\Features\Access\ScopeAttributePermission\Infrastructure\Driver\Rest\ScopeAttributePermissionDeleteController;
use Civi\Lughauth\Shared\Infrastructure\MicroPlugin;
use Civi\Lughauth\Shared\Event\EventListenersRegistrarInterface;
use Civi\Lughauth\Features\Access\ScopeAttributePermission\Application\Policy\Allow\Create\IsAutenticatedCreateAllow;
use Civi\Lughauth\Features\Access\ScopeAttributePermission\Application\Usecase\Create\ScopeAttributePermissionCreateAllowDecision;
use Civi\Lughauth\Features\Access\ScopeAttributePermission\Application\Policy\Allow\Update\IsAutenticatedUpdateAllow;
use Civi\Lughauth\Features\Access\ScopeAttributePermission\Application\Usecase\Update\ScopeAttributePermissionUpdateAllowDecision;
use Civi\Lughauth\Features\Access\ScopeAttributePermission\Application\Policy\Allow\Retrieve\IsAutenticatedRetrieveAllow;
use Civi\Lughauth\Features\Access\ScopeAttributePermission\Application\Usecase\Retrieve\ScopeAttributePermissionRetrieveAllowDecision;
use Civi\Lughauth\Features\Access\ScopeAttributePermission\Application\Policy\Allow\List\IsAutenticatedListAllow;
use Civi\Lughauth\Features\Access\ScopeAttributePermission\Application\Usecase\List\ScopeAttributePermissionListAllowDecision;
use Civi\Lughauth\Features\Access\ScopeAttributePermission\Application\Policy\Allow\Delete\IsAutenticatedDeleteAllow;
use Civi\Lughauth\Features\Access\ScopeAttributePermission\Application\Usecase\Delete\ScopeAttributePermissionDeleteAllowDecision;

class ScopeAttributePermissionPlugin extends MicroPlugin
{
    #[Override]
    public function registerRoutes(RouteCollectorProxy $app)
    {
        $app->group('/api/access/scope-attribute-permissions', [$this, 'setRoutesForScopeAttributePermission']);
        $app->group('/api/me/acl/access/scope-attribute-permissions', [$this, 'setRoutesForScopeAttributePermissionAcl']);
    }
    #[Override]
    public function registerEvents(EventListenersRegistrarInterface $bus)
    {
        $bus->registerListener(ScopeAttributePermissionCreateAllowDecision::class, IsAutenticatedCreateAllow::class);
        $bus->registerListener(ScopeAttributePermissionUpdateAllowDecision::class, IsAutenticatedUpdateAllow::class);
        $bus->registerListener(ScopeAttributePermissionRetrieveAllowDecision::class, IsAutenticatedRetrieveAllow::class);
        $bus->registerListener(ScopeAttributePermissionListAllowDecision::class, IsAutenticatedListAllow::class);
        $bus->registerListener(ScopeAttributePermissionDeleteAllowDecision::class, IsAutenticatedDeleteAllow::class);
    }
    public function setRoutesForScopeAttributePermissionAcl(RouteCollectorProxy $scopeAttributePermissionGroup)
    {
        $scopeAttributePermissionGroup->get('', [ScopeAttributePermissionAllowController::class, 'genericAllow']);
        $scopeAttributePermissionGroup->get('/{uid}', [ScopeAttributePermissionAllowController::class, 'contextualAllow']);
    }
    public function setRoutesForScopeAttributePermission(RouteCollectorProxy $scopeAttributePermissionGroup)
    {
        $scopeAttributePermissionGroup->get('', [ScopeAttributePermissionListController::class, 'list']);
        $scopeAttributePermissionGroup->post('', [ScopeAttributePermissionCreateController::class, 'create']);
        $scopeAttributePermissionGroup->get('/{uid}', [ScopeAttributePermissionRetrieveController::class, 'retrieve']);
        $scopeAttributePermissionGroup->put('/{uid}', [ScopeAttributePermissionUpdateController::class, 'update']);
        $scopeAttributePermissionGroup->delete('/{uid}', [ScopeAttributePermissionDeleteController::class, 'delete']);
        $scopeAttributePermissionGroup->delete('', [ScopeAttributePermissionDeleteController::class, 'deleteAllForQuery']);
        $scopeAttributePermissionGroup->get('/~/delete-status/{uid}', [ScopeAttributePermissionDeleteController::class, 'checkDeleteAllForQueryStatus']);
    }
}
