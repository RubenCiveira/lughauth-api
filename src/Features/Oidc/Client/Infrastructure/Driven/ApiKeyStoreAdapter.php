<?php

/* @autogenerated */
declare(strict_types=1);

namespace Civi\Lughauth\Features\Oidc\Client\Infrastructure\Driven;

// TO CHECK.

use Override;
use Civi\Lughauth\Features\Oidc\Client\Domain\ApiKeyData;
use Civi\Lughauth\Features\Oidc\Client\Domain\Gateway\ApiKeyStoreRepository;
use Civi\Lughauth\Features\Access\ApiKeyClient\Domain\Gateway\ApiKeyClientReadGateway;

class ApiKeyStoreAdapter implements ApiKeyStoreRepository
{
    public function __construct(
        private readonly ApiKeyClientReadGateway $apiKeys
    ) {
    }
    #[Override]
    public function apiKey(string $apiKey): ?ApiKeyData
    {
        $response = $this->apiKeys->findOneByKey($apiKey);
        if ($response) {
            return new ApiKeyData($apiKey, explode(",", $response->getScopes()));
        } else {
            return null;
        }
    }
}
