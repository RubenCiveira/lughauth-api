<?php

/* @autogenerated */
declare(strict_types=1);

namespace Civi\Lughauth\Features\Oidc\Authentication\Application\TokenGranter;

use Override;
use Civi\Lughauth\Features\Oidc\Authentication\Domain\AuthenticationRequest;
use Civi\Lughauth\Features\Oidc\Authentication\Domain\AuthenticationResult;
use Civi\Lughauth\Features\Oidc\User\Application\Usecase\LoginUsecase;

class ResolverForPassword implements TokenGranterStrategy
{
    public function __construct(private readonly LoginUsecase $userLoginGateway)
    {

    }

    #[Override]
    public function canHandle(string $grantType, array $params): bool
    {
        return 'password' === $grantType;
    }

    #[Override]
    public function autenticate(string $tenant, AuthenticationRequest $client, array $params): AuthenticationResult
    {
        return $this->userLoginGateway->validatedUserData($tenant, $params['username'], $params['password'], $client);
    }
}
