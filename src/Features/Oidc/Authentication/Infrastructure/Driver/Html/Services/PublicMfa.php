<?php

/* @autogenerated */
declare(strict_types=1);

namespace Civi\Lughauth\Features\Oidc\Authentication\Infrastructure\Driver\Html\Services;

use Civi\Lughauth\Features\Oidc\Mfa\Application\Usecase\UserMfa;
use Civi\Lughauth\Features\Oidc\Mfa\Domain\PublicLoginMfaBuildResponse;

class PublicMfa
{
    public function __construct(
        private readonly UserMfa $gateway
    ) {
    }
    public function configurationForNewMfa(string $tenant, string $username): PublicLoginMfaBuildResponse
    {
        return $this->gateway->configurationForNewMfa($tenant, $username);
    }

    public function verifyOtp(string $tenant, string $username, string $otp): bool
    {
        return $this->gateway->verifyOtp($tenant, $username, $otp);
    }

    public function verifyNewOpt(string $tenant, string $username, string $seed, string $otp): bool
    {
        if ($this->gateway->verifyNewOpt($tenant, $username, $seed, $otp)) {
            $this->gateway->storeSeed($tenant, $username, $seed);
            return true;
        } else {
            return false;
        }
    }
}
