<?php

/* @autogenerated */
declare(strict_types=1);

namespace Civi\Lughauth\Features\Oidc\Authentication\Domain;

class AuthenticationResult
{
    public const ERR_MFA_REQUIRED = 'MFA_REQUIRED';
    public const ERR_NEW_MFA_REQUIRED = 'NEW_MFA_REQUIRED';
    public const ERR_CONSENT_REQUIRED = 'CONSENT_REQUIRED';
    public const ERR_NEW_PASSWORD_REQUIRED = 'NEW_PASSWORD_REQUIRED';
    public const ERR_WAITING_PASSCHANGE_CODE = 'WAITING_PASSCHANGE_CODE';
    public const ERR_WAITING_USER_VERIFY = 'WAITING_USER_VERIFY';
    public const ERR_UNKNOW_USER = 'UNKNOW_USER';
    public const ERR_WRONG_CREDENTIAL = 'WRONG_CREDENTIAL';
    public const ERR_NOT_ALLOWED_ACCESS = 'NOT_ALLOWED_ACCESS';

    public static function waitNewpass($url, ?string $detail = null): AuthenticationResult
    {
        return new AuthenticationResult(valid: false, id: $url, error: self::ERR_WAITING_PASSCHANGE_CODE, errorMessage: $detail);
    }
    public static function waitNewuserVerify($url, ?string $detail = null): AuthenticationResult
    {
        return new AuthenticationResult(valid: false, id: $url, error: self::ERR_WAITING_USER_VERIFY, errorMessage: $detail);
    }
    public static function mfaRequired(?string $detail = null): AuthenticationResult
    {
        return new AuthenticationResult(valid: false, error: self::ERR_MFA_REQUIRED, errorMessage: $detail);
    }
    public static function newMfaRequired(?string $detail = null): AuthenticationResult
    {
        return new AuthenticationResult(valid: false, error: self::ERR_NEW_MFA_REQUIRED, errorMessage: $detail);
    }
    public static function consentRequired(?string $detail = null): AuthenticationResult
    {
        return new AuthenticationResult(valid: false, error: self::ERR_CONSENT_REQUIRED, errorMessage: $detail);
    }
    public static function newPasswordRequired(?string $detail = null): AuthenticationResult
    {
        return new AuthenticationResult(valid: false, error: self::ERR_NEW_PASSWORD_REQUIRED, errorMessage: $detail);
    }
    public static function unknowUser(string $tenant, string $username, ?string $detail = null): AuthenticationResult
    {
        return new AuthenticationResult(valid: false, error: self::ERR_UNKNOW_USER, errorMessage: $detail ?? self::ERR_UNKNOW_USER);
    }
    public static function wrongCredentials(string $tenant, string $username, ?string $detail = null): AuthenticationResult
    {
        return new AuthenticationResult(valid: false, error: self::ERR_WRONG_CREDENTIAL, errorMessage: $detail ?? self::ERR_WRONG_CREDENTIAL);
    }
    public static function notAllowedAccess(string $tenant, string $username, ?string $detail = null): AuthenticationResult
    {
        return new AuthenticationResult(valid: false, error: self::ERR_NOT_ALLOWED_ACCESS, errorMessage: $detail ?? self::ERR_NOT_ALLOWED_ACCESS);
    }

    public function __construct(
        public readonly bool $valid,
        public readonly ?string $id = null,
        public readonly ?string $error = null,
        public readonly ?string $errorMessage = null,
        public readonly ?string $tenant = null,
        public readonly ?string $tenantName = null,
        public readonly ?string $scope = null,
        public readonly ?array $audiences = [],
        public readonly mixed $roles = null,
        public readonly ?array $groups = null,
        public readonly ?string $name = null,
        public readonly ?string $email = null
    ) {
    }

}
