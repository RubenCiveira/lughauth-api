<?php

/* @autogenerated */
declare(strict_types=1);

namespace Civi\Lughauth\Features\Oidc\User\Application\Listener;

use Civi\Lughauth\Features\Notification\Message\Domain\Message;
use Civi\Lughauth\Features\Notification\Message\Application\Usecase\SendMessage;
use Civi\Lughauth\Features\Access\UserAccessTemporalCode\Domain\Event\UserAccessTemporalCodeGeneratePasswordRecoverEvent;

class NotifyRegister
{
    public function __construct(private readonly SendMessage $sender)
    {

    }
    public function __invoke(UserAccessTemporalCodeGeneratePasswordRecoverEvent $auth)
    {
        $message = new Message(
            targetName: 'Ruben Civeira',
            targetAddress: 'rubenciveira@gmail.com',
            subject: 'Recovery ' . $auth->payload->getRecoveryCode(),
            txtContent: 'Como estas',
            htmlContent: '<h1>Como estas</h1><p>Tenemos que ir a <a href="'.$auth->url.'">activar</a> en la url '.$auth->url
        );
        $this->sender->send($message);
    }
}
