<?php

/* @autogenerated */
declare(strict_types=1);

namespace Civi\Lughauth\Features\Oidc\User\Infrastructure\Driven;

use Civi\Lughauth\Features\Oidc\Authentication\Domain\AuthenticationResult;
use Civi\Lughauth\Features\Oidc\Authentication\Domain\Exception\LoginException;
use Override;
use Civi\Lughauth\Features\Oidc\User\Domain\Gateway\ChangePasswordRepository;

class ChangePasswordAdapter implements ChangePasswordRepository
{
    #[Override]
    public function requestForChange(string $url, string $tenant, string $username): void
    {
    }
    #[Override]
    public function allowRecover(string $tenant): bool
    {
        return true;
    }
    #[Override]
    public function validateChangeRequest(string $tenant, string $code, string $newPass): ?string
    {
        $valid = $code === "1111" && $newPass === "22";
        return $valid ? 'user' : null;
    }
    #[Override]
    public function forceUpdatePassword(string $tenant, string $username, string $oldPass, string $newPass): bool
    {
        if ($oldPass !== "1111") {
            throw new LoginException(AuthenticationResult::newPasswordRequired('wrong_old_pass'));
        }
        return $oldPass === "1111" && $newPass === "22";
    }
}
