<?php

/* @autogenerated */
declare(strict_types=1);

namespace Civi\Lughauth\Features\Rbac\Acl\Domain;

class Condition
{
    public function __construct(
        private string $operator,
        private string $field,
        private array|string $value
    ) {}

    public function matches(string $role): bool
    {
        if ($this->field !== 'role') {
            return false;
        }

        return match ($this->operator) {
            '==' => $role === $this->value,
            '!=' => $role !== $this->value,
            'in' => in_array($role, (array) $this->value, true),
            default => false,
        };
    }

    public static function fromArray(array $data): self
    {
        $op = key($data);
        $field = key($data[$op]);
        $value = $data[$op][$field];
        return new self($op, $field, $value);
    }

    public function toArray(): array
    {
        return [$this->operator => [$this->field => $this->value]];
    }

    public function getOperator(): string
    {
        return $this->operator;
    }

    public function getField(): string
    {
        return $this->field;
    }

    public function getValue(): array|string
    {
        return $this->value;
    }
}
