<?php

/* @autogenerated */
declare(strict_types=1);

namespace Civi\Lughauth\Features\Rbac\Resource\Domain\Gateway;

use Psr\Container\ContainerInterface;
use Civi\Lughauth\Features\Rbac\Resource\Infrastructure\Driven\RbacStoreAdapter;

class RbacStoreGateway
{
    private readonly RbacStoreRepository $repository;

    public function __construct(ContainerInterface $container, ?RbacStoreRepository $repository = null)
    {
        $this->repository = $repository ?? $container->get(RbacStoreAdapter::class);
    }

    /**
     * @param string $relyingParty
     * @param list<ScopeList> $paramMap
     */
    public function registerScopes(string $relyingParty, array $paramMap): void
    {
        $this->repository->registerScopes($relyingParty, $paramMap);
    }

    /**
     * @param string $relyingParty
     * @param list<Property> $paramMap
     */
    public function registerSchema(string $relyingParty, array $paramMap): void
    {
        $this->repository->registerSchema($relyingParty, $paramMap);
    }

    /**
     * @param string $relyingParty
     * @return list<RoleGrant>
     */
    public function granted(string $relyingParty): array
    {
        return $this->repository->granted($relyingParty);
    }
}
