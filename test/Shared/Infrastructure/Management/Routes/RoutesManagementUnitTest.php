<?php

/* @autogenerated */
declare(strict_types=1);

use PHPUnit\Framework\TestCase;
use Slim\Interfaces\RouteCollectorInterface;
use Slim\Interfaces\RouteInterface;
use Slim\App;
use Civi\Lughauth\Shared\Infrastructure\Management\Routes\RoutesManagement;

/**
 * Unit tests for {@see RoutesManagement}.
 */
final class RoutesManagementUnitTest extends TestCase
{
    /**
     * Ensures registered routes are reported by the handler.
     */
    public function testGetListsRoutes(): void
    {
        /* Arrange: build mocked routes and route collector. */
        $route = $this->createMock(RouteInterface::class);
        $route->method('getMethods')->willReturn(['GET', 'POST']);
        $route->method('getPattern')->willReturn('/users');
        $route->method('getName')->willReturn('users.list');

        $collector = $this->createMock(RouteCollectorInterface::class);
        $collector->method('getRoutes')->willReturn([$route]);

        $app = $this->createMock(App::class);
        $app->method('getRouteCollector')->willReturn($collector);

        $management = new RoutesManagement($app);

        /* Act: execute the routes handler. */
        $result = ($management->get())();
        $name = $management->name();

        /* Assert: verify endpoint name and route payload. */
        $this->assertSame('routes', $name);
        $this->assertSame([
            ['method' => 'GET', 'path' => '/users [name: users.list]'],
            ['method' => 'POST', 'path' => '/users [name: users.list]']
        ], $result);
    }
}
