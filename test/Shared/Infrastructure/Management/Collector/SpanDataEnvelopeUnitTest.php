<?php

/* @autogenerated */
declare(strict_types=1);

use PHPUnit\Framework\TestCase;
use OpenTelemetry\API\Trace\SpanContext;
use OpenTelemetry\SDK\Common\Attribute\Attributes;
use OpenTelemetry\SDK\Common\Instrumentation\InstrumentationScope;
use OpenTelemetry\SDK\Resource\ResourceInfo;
use Civi\Lughauth\Shared\Infrastructure\Management\Collector\SpanDataEnvelope;
use Civi\Lughauth\Shared\Infrastructure\Management\Collector\StatusDataEnvelope;

final class SpanDataEnvelopeUnitTest extends TestCase
{
    public function testGetters(): void
    {
        $context = SpanContext::create('4bf92f3577b34da6a3ce929d0e0e4736', '00f067aa0ba902b7');
        $parent = SpanContext::create('4bf92f3577b34da6a3ce929d0e0e4736', '1111111111111111');
        $attributes = Attributes::create(['k' => 'v']);
        $scope = new InstrumentationScope('test', '1.0', null, $attributes);
        $resource = ResourceInfo::create($attributes);

        $span = new SpanDataEnvelope(
            name: 'span',
            kind: 1,
            context: $context,
            parentContext: $parent,
            status: StatusDataEnvelope::ok(),
            startEpochNanos: 1,
            endEpochNanos: 2,
            attributes: $attributes,
            scope: $scope,
            resource: $resource
        );

        $this->assertSame('span', $span->getName());
        $this->assertSame(1, $span->getKind());
        $this->assertSame($context->getTraceId(), $span->getTraceId());
        $this->assertSame($context->getSpanId(), $span->getSpanId());
        $this->assertSame($parent->getSpanId(), $span->getParentSpanId());
        $this->assertSame(2, $span->getEndEpochNanos());
        $this->assertTrue($span->hasEnded());
        $this->assertSame($attributes, $span->getAttributes());
        $this->assertSame($scope, $span->getInstrumentationScope());
        $this->assertSame($resource, $span->getResource());
    }
}
