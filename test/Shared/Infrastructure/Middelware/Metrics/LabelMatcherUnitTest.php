<?php

/* @autogenerated */
declare(strict_types=1);

use PHPUnit\Framework\TestCase;
use Civi\Lughauth\Shared\Infrastructure\Middelware\Metrics\LabelMatcher;

final class LabelMatcherUnitTest extends TestCase
{
    public function testMatchesOperators(): void
    {
        $labels = ['status' => '200', 'path' => '/api'];

        $this->assertTrue((new LabelMatcher('status', '=', '200'))->matches($labels));
        $this->assertTrue((new LabelMatcher('status', '!=', '500'))->matches($labels));
        $this->assertTrue((new LabelMatcher('path', '=~', '/api'))->matches($labels));
        $this->assertTrue((new LabelMatcher('path', '!~', '/x'))->matches($labels));
        $this->assertFalse((new LabelMatcher('status', '=', '404'))->matches($labels));
    }

    public function testInvalidRegexReturnsFalse(): void
    {
        $labels = ['path' => '/api'];
        $this->assertFalse((new LabelMatcher('path', '=~', '(invalid'))->matches($labels));
    }
}
