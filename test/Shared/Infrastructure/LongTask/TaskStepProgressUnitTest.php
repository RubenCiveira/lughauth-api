<?php

/* @autogenerated */
declare(strict_types=1);

use PHPUnit\Framework\TestCase;
use Civi\Lughauth\Shared\Infrastructure\LongTask\TaskStepProgress;

/**
 * Unit tests for {@see TaskStepProgress}.
 */
final class TaskStepProgressUnitTest extends TestCase
{
    /**
     * Ensures status counts update when adding results.
     */
    public function testAddEntriesUpdatesProcessedItems(): void
    {
        /* Arrange: create a task step progress with initial arrays. */
        $progress = new TaskStepProgress(
            status: 'PENDING',
            totalItem: null,
            processedItems: 0,
            error: null,
            startTime: null,
            endTime: null,
            oks: [],
            warns: ['warn' => []],
            errors: ['error' => []]
        );

        /* Act: add ok, warning, and error entries. */
        $progress->addOk('ok');
        $progress->addWarn('warn', 'Be careful');
        $progress->addError('error', new RuntimeException('Boom'));

        /* Assert: verify counters and entries were updated. */
        $this->assertSame(3, $progress->processedItems);
        $this->assertSame(['ok'], $progress->oks);
        $this->assertSame(['warn' => ['Be careful']], $progress->warns);
        $this->assertInstanceOf(RuntimeException::class, $progress->errors['error']);
    }
}
