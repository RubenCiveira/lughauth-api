<?php

/* @autogenerated */
declare(strict_types=1);

use PHPUnit\Framework\TestCase;
use Civi\Lughauth\Shared\Value\Random;
use Ramsey\Uuid\Uuid;

final class RandomUnitTest extends TestCase
{
    public function testUuidGeneratesValidUuidV4(): void
    {
        $uuid = Random::uuid();
        $this->assertTrue(Uuid::isValid($uuid));
        $this->assertEquals(36, strlen($uuid));
    }

    public function testCombReturnsUuidPrefixWithTimestamp(): void
    {
        $comb = Random::comb();

        $this->assertMatchesRegularExpression('/^[0-9a-f\-]{20}[0-9a-f]{12}$/', $comb);
        $this->assertEquals(32, strlen($comb)); // 20 + 12 characters
    }

    public function testApiSecretReturnsSecureString(): void
    {
        $secret = Random::apiSecret();
        $this->assertIsString($secret);
        $this->assertEquals(33, strlen($secret));
    }

    public function testPasswordReturnsSecureString(): void
    {
        $password = Random::password();
        $this->assertIsString($password);
        $this->assertEquals(10, strlen($password));
    }

    public function testCombTimestampIsRecent(): void
    {
        $comb = Random::comb();
        $timestampHex = substr($comb, -12);
        $timestamp = hexdec($timestampHex);
        $now = (int) (microtime(true) * 1000);

        $this->assertLessThanOrEqual($now, $timestamp);
        $this->assertGreaterThan($now - 60000, $timestamp); // No mÃ¡s de 1 minuto en el pasado
    }
}
