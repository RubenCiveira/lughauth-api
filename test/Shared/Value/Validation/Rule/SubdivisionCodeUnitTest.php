<?php

/* @autogenerated */
declare(strict_types=1);

use PHPUnit\Framework\TestCase;
use Civi\Lughauth\Shared\Value\Validation\Rule\SubdivisionCode;
use Civi\Lughauth\Shared\Value\Validation\RuleFail;

final class SubdivisionCodeUnitTest extends TestCase
{
    public function testValidSubdivisionCodes(): void
    {
        $rule = new SubdivisionCode('ES');
        $this->assertNull($rule->check('GA'));
        $this->assertNull($rule->check('CA'));

        $ruleUS = new SubdivisionCode('US');
        $this->assertNull($ruleUS->check('CA'));
    }

    public function testInvalidSubdivisionCodes(): void
    {
        $rule = new SubdivisionCode('ES');
        $invalid = ['NAXGA', 'US-CA', 'ES--GA', '', null, 'es-ga'];

        foreach ($invalid as $code) {
            $result = $rule->check($code);
            $this->assertInstanceOf(RuleFail::class, $result);
            $this->assertEquals('rule_subdivision_code', $result->code);
            $this->assertEquals($code, $result->value);
            $this->assertEquals(['countryCode' => 'ES'], $result->expectedValues);
        }
    }
}
