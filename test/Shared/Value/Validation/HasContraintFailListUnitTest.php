<?php

/* @autogenerated */
declare(strict_types=1);

use PHPUnit\Framework\TestCase;
use Civi\Lughauth\Shared\Value\Validation\ConstraintFail;
use Civi\Lughauth\Shared\Value\Validation\HasContraintFailList;

final class HasContraintFailListUnitTest extends TestCase
{
    public function testAddErrorAndRetrieve(): void
    {
        $object = new class () {
            use HasContraintFailList;
        };

        $this->assertFalse($object->hasErrors());

        $fail = new ConstraintFail('code', ['field'], ['value'], []);
        $object->add($fail);

        $this->assertTrue($object->hasErrors());
        $this->assertFalse($object->isEmpty());
    }

    public function testAsConstraintException(): void
    {
        $object = new class () {
            use HasContraintFailList;
        };
        $fail = new ConstraintFail('code', ['field'], ['value'], []);
        $object->add($fail);

        $first = $object->asConstraintException();
        $second = $object->asConstraintException();

        $this->assertEquals($first, $second);
    }

    public function testIncludeViolationCode(): void
    {
        $object = new class () {
            use HasContraintFailList;
        };
        $fail = new ConstraintFail('12', ['field'], ['value'], []);
        $object->add($fail);

        $this->assertTrue($object->includeViolation(ConstraintFail::class));
        $this->assertFalse($object->includeViolation(HasContraintFailListUnitTest::class));

        $this->assertTrue($object->includeViolationCode(12));
        $this->assertFalse($object->includeViolationCode(22));

    }
}
