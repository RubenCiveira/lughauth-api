<?php

/* @autogenerated */
declare(strict_types=1);

use PHPUnit\Framework\TestCase;
use Civi\Lughauth\Shared\Security\Allow;

final class AllowUnitTest extends TestCase
{
    public function testAllowedFactory(): void
    {
        $allow = Allow::allowed('read', 'user is admin');
        $this->assertTrue($allow->allowed);
        $this->assertSame('read', $allow->name);
        $this->assertSame('user is admin', $allow->reason);
    }

    public function testDisallowedFactory(): void
    {
        $deny = Allow::disallowed('write', 'user is guest');
        $this->assertFalse($deny->allowed);
        $this->assertSame('write', $deny->name);
        $this->assertSame('user is guest', $deny->reason);
    }

    public function testAndAllowedAndAllowed(): void
    {
        $a = Allow::allowed('A');
        $b = Allow::allowed('B', 'reason B');
        $result = Allow::and('combined', $a, $b);

        $this->assertTrue($result->allowed);
        $this->assertSame('combined', $result->name);
        $this->assertSame('reason B', $result->reason);
    }

    public function testAndDisallowedFirst(): void
    {
        $a = Allow::disallowed('A', 'reason A');
        $b = Allow::allowed('B', 'reason B');
        $result = Allow::and('combined', $a, $b);

        $this->assertFalse($result->allowed);
        $this->assertSame('combined', $result->name);
        $this->assertSame('reason A', $result->reason);
    }

    public function testOrAllowedFirst(): void
    {
        $a = Allow::allowed('A', 'reason A');
        $b = Allow::disallowed('B', 'reason B');
        $result = Allow::or('combined', $a, $b);

        $this->assertTrue($result->allowed);
        $this->assertSame('combined', $result->name);
        $this->assertSame('reason A', $result->reason);
    }

    public function testOrDisallowedFirst(): void
    {
        $a = Allow::disallowed('A', 'reason A');
        $b = Allow::allowed('B', 'reason B');
        $result = Allow::or('combined', $a, $b);

        $this->assertTrue($result->allowed);
        $this->assertSame('combined', $result->name);
        $this->assertSame('reason B', $result->reason);
    }
}
