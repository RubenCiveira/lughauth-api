<?php

/* @autogenerated */
declare(strict_types=1);

use PHPUnit\Framework\TestCase;
use Civi\Lughauth\Shared\Security\Identity;

class IdentityUnitTest extends TestCase
{
    public function testAnonimousIdentity(): void
    {
        $identity = Identity::anonimous();

        $this->assertTrue($identity->anonimous);
        $this->assertSame(Identity::AUTH_SCOPE_NONE, $identity->authScope);
        $this->assertNull($identity->id);
        $this->assertNull($identity->name);
        $this->assertNull($identity->token);
        $this->assertNull($identity->issuer);
        $this->assertNull($identity->tenant);
        $this->assertNull($identity->roles);
        $this->assertNull($identity->groups);
        $this->assertNull($identity->claims);
        $this->assertNull($identity->scope);
    }

    public function testGetClaimWhenExists(): void
    {
        $identity = new Identity(false, claims: ['email' => 'user@example.com']);
        $this->assertSame('user@example.com', $identity->getClaim('email'));
    }

    public function testGetClaimWhenNotExists(): void
    {
        $identity = new Identity(false, claims: ['email' => 'user@example.com']);
        $this->assertNull($identity->getClaim('nonexistent'));
    }

    public function testGetClaimWhenClaimsIsNull(): void
    {
        $identity = new Identity(false, claims: null);
        $this->assertNull($identity->getClaim('any'));
    }

    public function testHasRoleTrue(): void
    {
        $identity = new Identity(false, roles: ['admin', 'user']);
        $this->assertTrue($identity->hasRole('admin'));
    }

    public function testHasRoleFalse(): void
    {
        $identity = new Identity(false, roles: ['admin', 'user']);
        $this->assertFalse($identity->hasRole('guest'));
    }

    public function testHasRoleWhenRolesIsNull(): void
    {
        $identity = new Identity(false, roles: null);
        $this->assertFalse($identity->hasRole('admin'));
    }

    public function testHasAnyRoleTrue(): void
    {
        $identity = new Identity(false, roles: ['editor', 'viewer']);
        $this->assertTrue($identity->hasAnyRole('guest', 'viewer'));
    }

    public function testHasAnyRoleFalse(): void
    {
        $identity = new Identity(false, roles: ['user']);
        $this->assertFalse($identity->hasAnyRole('admin', 'moderator'));
    }

    public function testHasAnyRoleWhenRolesIsNull(): void
    {
        $identity = new Identity(false, roles: null);
        $this->assertFalse($identity->hasAnyRole('admin'));
    }

    public function testHasScope()
    {
        $identity = new Identity(anonimous: false, scope: 'read write delete');
        $this->assertTrue($identity->hasScope('read'));
        $this->assertTrue($identity->hasScope('write'));
        $this->assertTrue($identity->hasScope('delete'));
        $this->assertFalse($identity->hasScope('admin'));
    }

    public function testHasScopeWhenNull()
    {
        $identity = new Identity(anonimous: false, scope: null);
        $this->assertFalse($identity->hasScope('read'));
    }

    public function testHasScopeWhenEmpty()
    {
        $identity = new Identity(anonimous: false, scope: '');
        $this->assertFalse($identity->hasScope('read'));
    }

    public function testHasScopeWithEmptySearch()
    {
        $identity = new Identity(anonimous: false, scope: 'read');
        $this->assertFalse($identity->hasScope(''));
    }

    public function testHasScopeWithDuplicate()
    {
        $identity = new Identity(anonimous: false, scope: 'read read');
        $this->assertTrue($identity->hasScope('read'));
    }

    public function testHasScopePartialWord()
    {
        $identity = new Identity(anonimous: false, scope: 'readwrite');
        $this->assertFalse($identity->hasScope('read'));
    }
}
