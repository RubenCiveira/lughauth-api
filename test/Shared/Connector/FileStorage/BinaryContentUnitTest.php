<?php

/* @autogenerated */
declare(strict_types=1);

use PHPUnit\Framework\TestCase;
use Civi\Lughauth\Shared\Connector\FileStorage\BinaryContent;

final class BinaryContentUnitTest extends TestCase
{
    public function testFromFileCreatesBinaryContent(): void
    {
        $path = tempnam(sys_get_temp_dir(), 'binary_');
        file_put_contents($path, 'payload');
        $content = null;

        try {
            $content = BinaryContent::fromFile($path);

            $this->assertSame(basename($path), $content->name);
            $this->assertSame('binary', $content->mime);
            $this->assertInstanceOf(DateTime::class, $content->lastChange);
            $this->assertIsResource($content->stream);
        } finally {
            if ($content && is_resource($content->stream)) {
                fclose($content->stream);
            }
            unlink($path);
        }
    }

    public function testConstructorStoresValues(): void
    {
        $date = new DateTime('2024-01-01');
        $stream = fopen('php://temp', 'r+');
        $content = new BinaryContent('name', 'mime', $date, $stream, 'https://example.com/file');

        $this->assertSame('name', $content->name);
        $this->assertSame('mime', $content->mime);
        $this->assertSame($date, $content->lastChange);
        $this->assertSame($stream, $content->stream);
        $this->assertSame('https://example.com/file', $content->publicUrl);

        fclose($stream);
    }
}
